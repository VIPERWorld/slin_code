DROP VIEW IF EXISTS `entity_v`;
CREATE VIEW  `entity_v` AS select `e`.`pkey` AS `PKEY`,`e`.`name` AS `NAME`,`e`.`address` AS `ADDRESS`,`e`.`description` AS `DESCRIPTION`,`e`.`subsystemkey` AS `SUBSYSTEMKEY`,`subsystem`.`name` AS `SUBSYSTEMNAME`,`e`.`locationkey` AS `LOCATIONKEY`,`location`.`name` AS `LOCATIONNAME`,`e`.`seregi_id` AS `SEREGI_ID`,`se_region`.`name` AS `SEREGINAME`,`e`.`typekey` AS `TYPEKEY`,`entitytype`.`name` AS `TYPENAME`,if(`e`.`physical_subsystem_key` is null or `e`.`physical_subsystem_key` = '',0,`e`.`physical_subsystem_key`) AS `PHYSICAL_SUBSYSTEM_KEY`,`subsystem2`.`name` AS `PHYSICAL_SUBSYSTEM_NAME`,`e`.`scsdat_id` AS `SCSDAT_ID`,`sc`.`name` AS `SCSDATNAME`,`e`.`parentkey` AS `PARENTKEY`,`entity2`.`name` AS `PARENTNAME`,`e`.`agentkey` AS `AGENTKEY`,`entity3`.`name` AS `AGENTNAME`,`e`.`deleted` AS `DELETED`,`e`.`created_by` AS `CREATED_BY`,`e`.`date_created` AS `DATE_CREATED`,`e`.`modified_by` AS `MODIFIED_BY`,`e`.`date_modified` AS `DATE_MODIFIED` from ((((((((`entity` `e` left join `subsystem` on((`subsystem`.`pkey` = `e`.`subsystemkey`))) left join `location` on((`location`.`pkey` = `e`.`locationkey`))) left join `se_region` on((`se_region`.`seregi_id` = `e`.`seregi_id`))) left join `entitytype` on((`entitytype`.`pkey` = `e`.`typekey`))) left join `subsystem` `subsystem2` on((`subsystem2`.`pkey` = if(`e`.`physical_subsystem_key` is null or `e`.`physical_subsystem_key` = '',0,`e`.`physical_subsystem_key`)))) left join `sc_scada_datatypes` `sc` on((`sc`.`scsdat_id` = `e`.`scsdat_id`))) left join `entity` `entity2` on((`entity2`.`pkey` = `e`.`parentkey`))) left join `entity` `entity3` on((`entity3`.`pkey` = `e`.`agentkey`)));

DROP VIEW IF EXISTS `entityparameter_v`;
CREATE VIEW  `entityparameter_v` AS select `ep`.`pkey` AS `PKEY`,`ep`.`name` AS `NAME`,`et1`.`name` AS `TYPENAME`,`ep`.`typekey` AS `TYPEKEY`,`et1`.`sys_site` AS `SYS_SITE`,`ep`.`order_seq` AS `ORDER_SEQ`,`ep`.`description` AS `DESCRIPTION`,`ep`.`drivertypekey` AS `DRIVERTYPEKEY`,`et2`.`name` AS `DRIVERTYPENAME`,`ep`.`ep_mandatory` AS `EP_MANDATORY`,`ep`.`ep_default` AS `EP_DEFAULT`,`ep`.`ep_default_datatype` AS `EP_DEFAULT_DATATYPE`,`epd`.`datatype` AS `DATATYPE`,`ep`.`ep_validation` AS `EP_VALIDATION`,`ep`.`visible` AS `VISIBLE`,`ep`.`onlineupdate` AS `ONLINEUPDATE`,`ep`.`ec_field` AS `EC_FIELD` from (((`entityparameter` `ep` join `entityparameterdatatype` `epd`) join `entitytype` `et1`) join `entitytype` `et2`) where ((`ep`.`ep_default_datatype` = `epd`.`pkey`) and (`ep`.`typekey` = `et1`.`pkey`) and (`ep`.`drivertypekey` = `et2`.`pkey`));

DROP VIEW IF EXISTS `entityparametervalue_v`;
CREATE VIEW `entityparametervalue_v` AS select `epv`.`pkey` AS `PKEY`,`epv`.`entitykey` AS `ENTITYKEY`,`epv`.`parameterkey` AS `PARAMETERKEY`,`entitytype`.`name` AS `TYPENAME`,`entity`.`name` AS `ENTITYNAME`,`ep`.`name` AS `PARAMETERNAME`,`ep`.`ep_default_datatype` AS `PARAMETERDATATYPE`,`epv`.`value` AS `VALUE` from ((`entityparametervalue` `epv` left join `entity` on((`entity`.`pkey` = `epv`.`entitykey`))) join (`entityparameter` `ep` left join `entitytype` on((`entitytype`.`pkey` = `ep`.`typekey`)))) where (`epv`.`parameterkey` = `ep`.`pkey`);

DROP VIEW IF EXISTS `entitytype_v`;
CREATE VIEW  `entitytype_v` AS select `et1`.`pkey` AS `PKEY`,`et1`.`name` AS `NAME`,`et1`.`sys_site` AS `SYS_SITE`,`et1`.`description` AS `DESCRIPTION`,`et1`.`default_parenttype` AS `DEFAULT_PARENTTYPE`,`et2`.`name` AS `DEFAULT_PARENTTYPE_NAME`,`et1`.`guiapplicationkey` AS `GUIAPPLICATIONKEY`,`ga`.`name` AS `GUINAME`,`et1`.`ta_subsystemkey` AS `TA_SUBSYSTEMKEY`,`ss`.`name` AS `SUBSYSNAME`,`et1`.`name_tip` AS `NAME_TIP`,`et1`.`address_tip` AS `ADDRESS_TIP`,`et1`.`description_tip` AS `DESCRIPTION_TIP`,`et1`.`subsystem_tip` AS `SUBSYSTEM_TIP`,`et1`.`location_tip` AS `LOCATION_TIP`,`et1`.`parent_tip` AS `PARENT_TIP`,`et1`.`executable_tip` AS `EXECUTABLE_TIP` from (((`entitytype` `et1` join `entitytype` `et2`) join `subsystem` `ss`) join `guiapplication` `ga`) where ((`et1`.`guiapplicationkey` = `ga`.`pkey`) and (`et1`.`ta_subsystemkey` = `ss`.`pkey`) and (`et1`.`default_parenttype` = `et2`.`pkey`));


DROP VIEW IF EXISTS `alarm_inhibition_view`;
CREATE VIEW  `alarm_inhibition_view` AS select 'Unremovable' AS `REMOVABLE`,if(`a`.`date_modified` is null or `a`.`date_modified` = '',`a`.`date_created`,`a`.`date_modified`) AS `DATE_TIME`,if((select `ae_alarm_rule_param`.`action_parameter_value` from `ae_alarm_rule_param` where ((`ae_alarm_rule_param`.`action_parameter_type` = 'ASSETNAME') and (`ae_alarm_rule_param`.`alarm_rule_key` = `a`.`pkey`)) limit 1) is null or (select `ae_alarm_rule_param`.`action_parameter_value` from `ae_alarm_rule_param` where ((`ae_alarm_rule_param`.`action_parameter_type` = 'ASSETNAME') and (`ae_alarm_rule_param`.`alarm_rule_key` = `a`.`pkey`)) limit 1) = '',`entity`.`name`,`ae_alarm_rule_param`.`action_parameter_value`) AS `ASSET_NAME`,`me_alarm_type`.`type_name` AS `ALARM_TYPE`,`a`.`alarmdescription` AS `ALARMDESCRIPTION`,if((select `ae_alarm_rule_param`.`action_parameter_value` from `ae_alarm_rule_param` where ((`ae_alarm_rule_param`.`action_parameter_type` = 'VALUE') and (`ae_alarm_rule_param`.`alarm_rule_key` = `a`.`pkey`)) limit 1) is null or (select `ae_alarm_rule_param`.`action_parameter_value` from `ae_alarm_rule_param` where ((`ae_alarm_rule_param`.`action_parameter_type` = 'VALUE') and (`ae_alarm_rule_param`.`alarm_rule_key` = `a`.`pkey`)) limit 1) = '','-',`ae_alarm_rule_param`.`action_parameter_value`) AS `VALUE`,if(`o`.`name` is null or `o`.`name` = '','-',`o`.`name`) AS `OPERATOR` from ((((`ae_alarm_rule_param` join `entity`) join `me_alarm_type`) join `ta_session`) join ((`alarmrule` `a` left join `ta_session` `s` on((`s`.`pkey` = `a`.`created_by_session_key`))) left join `operator` `o` on((`s`.`operatorkey` = `o`.`pkey`)))) where (((`a`.`ruletype` = 'SuppressionByType') or (`a`.`ruletype` = 'SuppressionByDescription')) and (`entity`.`pkey` = `a`.`entitykey`) and (`me_alarm_type`.`meatyp_id` = `a`.`alarmtype`));

DROP VIEW IF EXISTS `at_fixed_block_map_v`;
CREATE VIEW  `at_fixed_block_map_v` AS select `m`.`atfblo_id` AS `ATFBLO_ID`,`m`.`branch_id` AS `BRANCH_ID`,(select `abt`.`track` from `at_branch_track` `abt` where (`abt`.`atbtra_id` = `m`.`branch_id`)) AS `TRACK`,`m`.`min_abscissa` AS `MIN_ABSCISSA`,`m`.`max_abscissa` AS `MAX_ABSCISSA`,`m`.`generic_id` AS `GENERIC_ID`,`m`.`zone_type` AS `ZONE_TYPE`,(select `zonetype`.`name` from `zonetype` where (`zonetype`.`pkey` = `m`.`zone_type`)) AS `ZONE_TYPE_NAME`,`m`.`created_by` AS `CREATED_BY`,`m`.`date_created` AS `DATE_CREATED`,`m`.`modified_by` AS `MODIFIED_BY`,`m`.`date_modified` AS `DATE_MODIFIED` from `at_fixed_block_map` `m` order by `m`.`zone_type`,`m`.`branch_id`,`m`.`min_abscissa`;

DROP VIEW IF EXISTS `at_power_entity_map_v`;
CREATE VIEW  `at_power_entity_map_v` AS select `m`.`atpoem_id` AS `ATPOEM_ID`,`m`.`subsection_id` AS `SUBSECTION_ID`,`m`.`bit_position` AS `BIT_POSITION`,`m`.`data_point_entity_key` AS `DATA_POINT_ENTITY_KEY`,`m`.`location_key` AS `STATION_ID`,`z`.`mss_zone` AS `MSS_ZONE`,`m`.`created_by` AS `CREATED_BY`,`m`.`date_created` AS `DATE_CREATED`,`m`.`modified_by` AS `MODIFIED_BY`,`m`.`date_modified` AS `DATE_MODIFIED` from (`at_power_entity_map` `m` left join `at_msszone` `z` on((`m`.`location_key` = `z`.`station_id`)));

DROP VIEW IF EXISTS `at_psd_entity_map_v`;
CREATE VIEW  `at_psd_entity_map_v` AS select `m`.`atpema_id` AS `ATPEMA_ID`,`a`.`station_id` AS `STATION_ID`,`m`.`platform_key` AS `PLATFORM_KEY`,`a`.`platform_id` AS `PLATFORM_ID`,`a`.`platform_name` AS `PLATFORM_NAME`,`a`.`tis_platform_id` AS `TIS_PLATFORM_ID`,`z`.`mss_zone` AS `MSS_ZONE`,`m`.`psd_number` AS `PSD_NUMBER`,`m`.`data_point_entity_key` AS `DATA_POINT_ENTITY_KEY`,`m`.`data_point_type` AS `DATA_POINT_TYPE`,`m`.`data_point_nameof_type` AS `DATA_POINT_NAMEOF_TYPE`,`m`.`created_by` AS `CREATED_BY`,`m`.`date_created` AS `DATE_CREATED`,`m`.`modified_by` AS `MODIFIED_BY`,`m`.`date_modified` AS `DATE_MODIFIED` from (`at_psd_entity_map` `m` join (`at_platform` `a` left join `at_msszone` `z` on((`a`.`station_id` = `z`.`station_id`)))) where (`m`.`platform_key` = `a`.`atplat_id`);

DROP VIEW IF EXISTS `category_details`;
CREATE VIEW  `category_details` AS select `node_tree`.`parent_node` AS `PARENT`,`node_tree`.`p_key` AS `NODE_ID`,`node_tree`.`name` AS `NAME`,`node_tree`.`description` AS `DESCRIPTION` from (`node_tree` join `node_type`) where ((`node_tree`.`fk_node_type` = `node_type`.`p_key`) and (`node_type`.`type_name` = 'Category'));

DROP VIEW IF EXISTS `datanode_ev`;
CREATE VIEW  `datanode_ev` AS select `e`.`pkey` AS `pkey`,`e`.`name` AS `name`,`sub`.`name` AS `subsysname`,`loc`.`name` AS `locationname`,`sereg`.`name` AS `regionname`,`et`.`name` AS `typename`,`sub2`.`name` AS `physicalname`,`e`.`name` AS `parentname`,`e`.`name` AS `agentname`,`scdata`.`name` AS `scsdatname`,`e`.`address` AS `ADDRESS`,`e`.`description` AS `DESCRIPTION`,`e`.`subsystemkey` AS `SUBSYSTEMKEY`,`e`.`locationkey` AS `LOCATIONKEY`,`e`.`seregi_id` AS `SEREGI_ID`,`e`.`typekey` AS `TYPEKEY`,`e`.`physical_subsystem_key` AS `PHYSICAL_SUBSYSTEM_KEY`,`e`.`scsdat_id` AS `SCSDAT_ID`,`e`.`parentkey` AS `PARENTKEY`,`e`.`agentkey` AS `AGENTKEY`,`e`.`deleted` AS `DELETED`,`epv104`.`value` AS `LABEL`,`epv105`.`value` AS `SHORTLABEL`,`epv106`.`value` AS `ASSETNAME`,`epv107`.`value` AS `DISPLAYORDER`,`epv108`.`value` AS `LISTOFCHILDENTITIES`,`epv109`.`value` AS `SYNTHESISTYPE`,`epv110`.`value` AS `TAGSTATUS`,`epv111`.`value` AS `TAGOUTPUTINHIBITSTATUS`,`epv112`.`value` AS `TAGINPUTINHIBITSTATUS`,`epv113`.`value` AS `TAGOWNER`,`epv114`.`value` AS `TAGPTW`,`epv115`.`value` AS `PTWCOMMENTS`,`epv116`.`value` AS `NOTES`,`epv117`.`value` AS `LASTOPERATORSESSIONID`,`epv118`.`value` AS `LASTOPERATORTIMESTAMP`,`epv119`.`value` AS `ALARMDISPLAY`,`epv120`.`value` AS `INHIBITMMS`,`epv121`.`value` AS `SWCADDRESS`,`epv122`.`value` AS `SCADASYSTEM` from (((((((((((((((((((((((((((`entity` `e` left join `entitytype` `et` on((`e`.`typekey` = `et`.`pkey`))) left join `subsystem` `sub` on((`e`.`subsystemkey` = `sub`.`pkey`))) left join `location` `loc` on((`e`.`locationkey` = `loc`.`pkey`))) left join `se_region` `sereg` on((`e`.`seregi_id` = `sereg`.`seregi_id`))) left join `subsystem` `sub2` on((`e`.`physical_subsystem_key` = `sub2`.`pkey`))) left join `entity` `ent1` on((`e`.`parentkey` = `ent1`.`pkey`))) left join `entity` `ent2` on((`e`.`agentkey` = `ent2`.`pkey`))) left join `sc_scada_datatypes` `scdata` on((`e`.`scsdat_id` = `scdata`.`scsdat_id`))) left join `entityparametervalue` `epv104` on(((`e`.`pkey` = `epv104`.`entitykey`) and (`epv104`.`parameterkey` = 104)))) left join `entityparametervalue` `epv105` on(((`e`.`pkey` = `epv105`.`entitykey`) and (`epv105`.`parameterkey` = 105)))) left join `entityparametervalue` `epv106` on(((`e`.`pkey` = `epv106`.`entitykey`) and (`epv106`.`parameterkey` = 106)))) left join `entityparametervalue` `epv107` on(((`e`.`pkey` = `epv107`.`entitykey`) and (`epv107`.`parameterkey` = 107)))) left join `entityparametervalue` `epv108` on(((`e`.`pkey` = `epv108`.`entitykey`) and (`epv108`.`parameterkey` = 108)))) left join `entityparametervalue` `epv109` on(((`e`.`pkey` = `epv109`.`entitykey`) and (`epv109`.`parameterkey` = 109)))) left join `entityparametervalue` `epv110` on(((`e`.`pkey` = `epv110`.`entitykey`) and (`epv110`.`parameterkey` = 110)))) left join `entityparametervalue` `epv111` on(((`e`.`pkey` = `epv111`.`entitykey`) and (`epv111`.`parameterkey` = 111)))) left join `entityparametervalue` `epv112` on(((`e`.`pkey` = `epv112`.`entitykey`) and (`epv112`.`parameterkey` = 112)))) left join `entityparametervalue` `epv113` on(((`e`.`pkey` = `epv113`.`entitykey`) and (`epv113`.`parameterkey` = 113)))) left join `entityparametervalue` `epv114` on(((`e`.`pkey` = `epv114`.`entitykey`) and (`epv114`.`parameterkey` = 114)))) left join `entityparametervalue` `epv115` on(((`e`.`pkey` = `epv115`.`entitykey`) and (`epv115`.`parameterkey` = 115)))) left join `entityparametervalue` `epv116` on(((`e`.`pkey` = `epv116`.`entitykey`) and (`epv116`.`parameterkey` = 116)))) left join `entityparametervalue` `epv117` on(((`e`.`pkey` = `epv117`.`entitykey`) and (`epv117`.`parameterkey` = 117)))) left join `entityparametervalue` `epv118` on(((`e`.`pkey` = `epv118`.`entitykey`) and (`epv118`.`parameterkey` = 118)))) left join `entityparametervalue` `epv119` on(((`e`.`pkey` = `epv119`.`entitykey`) and (`epv119`.`parameterkey` = 119)))) left join `entityparametervalue` `epv120` on(((`e`.`pkey` = `epv120`.`entitykey`) and (`epv120`.`parameterkey` = 120)))) left join `entityparametervalue` `epv121` on(((`e`.`pkey` = `epv121`.`entitykey`) and (`epv121`.`parameterkey` = 121)))) left join `entityparametervalue` `epv122` on(((`e`.`pkey` = `epv122`.`entitykey`) and (`epv122`.`parameterkey` = 122)))) where (`et`.`name` = 'DataNode');

DROP VIEW IF EXISTS `datanodeagent_ev`;
CREATE VIEW  `datanodeagent_ev` AS select `e`.`pkey` AS `PKEY`,`e`.`name` AS `NAME`,(select `s`.`name` from (`entity` `e` left join `subsystem` `s` on((`s`.`pkey` = `e`.`subsystemkey`)))) AS `SUBSYSNAME`,(select `l`.`name` from (`entity` `e` left join `location` `l` on((`l`.`pkey` = `e`.`locationkey`)))) AS `LOCATIONNAME`,(select `s`.`name` from (`entity` `e` left join `se_region` `s` on((`s`.`seregi_id` = `e`.`seregi_id`)))) AS `REGIONNAME`,`et`.`name` AS `TYPENAME`,(select `s`.`name` from (`entity` `e` left join `subsystem` `s` on((`s`.`pkey` = `e`.`physical_subsystem_key`)))) AS `PHYSICALNAME`,(select `en`.`name` from (`entity` `e` left join `entity` `en` on((`en`.`pkey` = `e`.`parentkey`)))) AS `PARENTNAME`,(select `en`.`name` from (`entity` `e` left join `entity` `en` on((`en`.`pkey` = `e`.`agentkey`)))) AS `AGENTNAME`,(select `s`.`name` from (`entity` `e` left join `sc_scada_datatypes` `s` on((`s`.`scsdat_id` = `e`.`scsdat_id`)))) AS `SCSDATNAME`,`e`.`address` AS `ADDRESS`,`e`.`description` AS `DESCRIPTION`,`e`.`subsystemkey` AS `SUBSYSTEMKEY`,`e`.`locationkey` AS `LOCATIONKEY`,`e`.`seregi_id` AS `SEREGI_ID`,`e`.`typekey` AS `TYPEKEY`,`e`.`physical_subsystem_key` AS `PHYSICAL_SUBSYSTEM_KEY`,`e`.`scsdat_id` AS `SCSDAT_ID`,`e`.`parentkey` AS `PARENTKEY`,`e`.`agentkey` AS `AGENTKEY`,`e`.`deleted` AS `DELETED`,(select `ep`.`value` from (`entity` `e` left join `entityparametervalue` `ep` on((`ep`.`entitykey` = `e`.`pkey`))) where (`ep`.`parameterkey` = 127)) AS `SCANTIMEMSECS` from (`entity` `e` left join `entitytype` `et` on((`e`.`typekey` = `et`.`pkey`))) where (`et`.`name` = 'DataNodeAgent');

DROP VIEW IF EXISTS `datapoint_ev_01`;
CREATE VIEW  `datapoint_ev_01` AS select `e`.`pkey` AS `pkey`,`e`.`name` AS `name`,`sub`.`name` AS `subsysname`,`loc`.`name` AS `locationname`,`sereg`.`name` AS `regionname`,`et`.`name` AS `typename`,`sub2`.`name` AS `physicalname`,`e`.`name` AS `parentname`,`e`.`name` AS `agentname`,`scdata`.`name` AS `scsdatname`,`e`.`address` AS `ADDRESS`,`e`.`description` AS `DESCRIPTION`,`e`.`subsystemkey` AS `SUBSYSTEMKEY`,`e`.`locationkey` AS `LOCATIONKEY`,`e`.`seregi_id` AS `SEREGI_ID`,`e`.`typekey` AS `TYPEKEY`,`e`.`physical_subsystem_key` AS `PHYSICAL_SUBSYSTEM_KEY`,`e`.`scsdat_id` AS `SCSDAT_ID`,`e`.`parentkey` AS `PARENTKEY`,`e`.`agentkey` AS `AGENTKEY`,`e`.`deleted` AS `DELETED`,`epv167`.`value` AS `DATAPOINTTYPE`,`epv168`.`value` AS `DATATYPESHORTNAME`,`epv169`.`value` AS `HELPURL`,`epv170`.`value` AS `SCANTIMEFACTOR`,`epv171`.`value` AS `ENABLEHELPURL`,`epv172`.`value` AS `ENGINEERINGNOTE`,`epv173`.`value` AS `ENABLEENGINEERINGNOTE`,`epv174`.`value` AS `ENABLETRENDING`,`epv175`.`value` AS `FALSEALARMSEVERITY`,`epv176`.`value` AS `FALSEALARMDELAY`,`epv177`.`value` AS `FALSEALARMMESSAGE`,`epv178`.`value` AS `FALSEALARMENABLE`,`epv179`.`value` AS `TRUEALARMSEVERITY`,`epv180`.`value` AS `TRUEALARMDELAY`,`epv181`.`value` AS `TRUEALARMMESSAGE`,`epv182`.`value` AS `TRUEALARMENABLE`,`epv183`.`value` AS `LOLOSEVERITY`,`epv184`.`value` AS `LOLOALARMDELAY`,`epv185`.`value` AS `LOLOALARMMESSAGE`,`epv186`.`value` AS `LOLOALARMVALUE`,`epv187`.`value` AS `LOLOALARMENABLED`,`epv188`.`value` AS `LOSEVERITY`,`epv189`.`value` AS `LOALARMDELAY`,`epv190`.`value` AS `LOALARMMESSAGE`,`epv191`.`value` AS `LOALARMVALUE`,`epv192`.`value` AS `LOALARMENABLED`,`epv193`.`value` AS `HISEVERITY`,`epv194`.`value` AS `HIALARMDELAY`,`epv195`.`value` AS `HIALARMMESSAGE`,`epv196`.`value` AS `HIALARMVALUE`,`epv197`.`value` AS `HIALARMENABLED`,`epv198`.`value` AS `HIHISEVERITY`,`epv199`.`value` AS `HIHIALARMDELAY`,`epv200`.`value` AS `HIHIALARMMESSAGE`,`epv201`.`value` AS `HIHIALARMVALUE`,`epv202`.`value` AS `HIHIALARMENABLED`,`epv203`.`value` AS `FALSELABEL`,`epv204`.`value` AS `TRUELABEL`,`epv205`.`value` AS `ENGINEERINGLIMITHIGH`,`epv206`.`value` AS `ENGINEERINGLIMITLOW`,`epv207`.`value` AS `RAWLIMITHIGH`,`epv208`.`value` AS `RAWLIMITLOW`,`epv209`.`value` AS `ZEROVALUETHRESHOLD`,`epv210`.`value` AS `PRECISION`,`epv211`.`value` AS `UNITLABEL`,`epv212`.`value` AS `CONVERSIONENABLED`,`epv213`.`value` AS `UPDATETIMELIMIT`,`epv214`.`value` AS `UPDATETHRESHOLD`,`epv215`.`value` AS `ALARMTHRESHOLD`,`epv216`.`value` AS `ALARMDISPLAY`,`epv217`.`value` AS `ALLOWWRITE`,`epv218`.`value` AS `SERVICESTATE` from ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((`entity` `e` left join `entitytype` `et` on((`e`.`typekey` = `et`.`pkey`))) left join `subsystem` `sub` on((`e`.`subsystemkey` = `sub`.`pkey`))) left join `location` `loc` on((`e`.`locationkey` = `loc`.`pkey`))) left join `se_region` `sereg` on((`e`.`seregi_id` = `sereg`.`seregi_id`))) left join `subsystem` `sub2` on((`e`.`physical_subsystem_key` = `sub2`.`pkey`))) left join `entity` `ent1` on((`e`.`parentkey` = `ent1`.`pkey`))) left join `entity` `ent2` on((`e`.`agentkey` = `ent2`.`pkey`))) left join `sc_scada_datatypes` `scdata` on((`e`.`scsdat_id` = `scdata`.`scsdat_id`))) left join `entityparametervalue` `epv167` on(((`e`.`pkey` = `epv167`.`entitykey`) and (`epv167`.`parameterkey` = 167)))) left join `entityparametervalue` `epv168` on(((`e`.`pkey` = `epv168`.`entitykey`) and (`epv168`.`parameterkey` = 168)))) left join `entityparametervalue` `epv169` on(((`e`.`pkey` = `epv169`.`entitykey`) and (`epv169`.`parameterkey` = 169)))) left join `entityparametervalue` `epv170` on(((`e`.`pkey` = `epv170`.`entitykey`) and (`epv170`.`parameterkey` = 170)))) left join `entityparametervalue` `epv171` on(((`e`.`pkey` = `epv171`.`entitykey`) and (`epv171`.`parameterkey` = 171)))) left join `entityparametervalue` `epv172` on(((`e`.`pkey` = `epv172`.`entitykey`) and (`epv172`.`parameterkey` = 172)))) left join `entityparametervalue` `epv173` on(((`e`.`pkey` = `epv173`.`entitykey`) and (`epv173`.`parameterkey` = 173)))) left join `entityparametervalue` `epv174` on(((`e`.`pkey` = `epv174`.`entitykey`) and (`epv174`.`parameterkey` = 174)))) left join `entityparametervalue` `epv175` on(((`e`.`pkey` = `epv175`.`entitykey`) and (`epv175`.`parameterkey` = 175)))) left join `entityparametervalue` `epv176` on(((`e`.`pkey` = `epv176`.`entitykey`) and (`epv176`.`parameterkey` = 176)))) left join `entityparametervalue` `epv177` on(((`e`.`pkey` = `epv177`.`entitykey`) and (`epv177`.`parameterkey` = 177)))) left join `entityparametervalue` `epv178` on(((`e`.`pkey` = `epv178`.`entitykey`) and (`epv178`.`parameterkey` = 178)))) left join `entityparametervalue` `epv179` on(((`e`.`pkey` = `epv179`.`entitykey`) and (`epv179`.`parameterkey` = 179)))) left join `entityparametervalue` `epv180` on(((`e`.`pkey` = `epv180`.`entitykey`) and (`epv180`.`parameterkey` = 180)))) left join `entityparametervalue` `epv181` on(((`e`.`pkey` = `epv181`.`entitykey`) and (`epv181`.`parameterkey` = 181)))) left join `entityparametervalue` `epv182` on(((`e`.`pkey` = `epv182`.`entitykey`) and (`epv182`.`parameterkey` = 182)))) left join `entityparametervalue` `epv183` on(((`e`.`pkey` = `epv183`.`entitykey`) and (`epv183`.`parameterkey` = 183)))) left join `entityparametervalue` `epv184` on(((`e`.`pkey` = `epv184`.`entitykey`) and (`epv184`.`parameterkey` = 184)))) left join `entityparametervalue` `epv185` on(((`e`.`pkey` = `epv185`.`entitykey`) and (`epv185`.`parameterkey` = 185)))) left join `entityparametervalue` `epv186` on(((`e`.`pkey` = `epv186`.`entitykey`) and (`epv186`.`parameterkey` = 186)))) left join `entityparametervalue` `epv187` on(((`e`.`pkey` = `epv187`.`entitykey`) and (`epv187`.`parameterkey` = 187)))) left join `entityparametervalue` `epv188` on(((`e`.`pkey` = `epv188`.`entitykey`) and (`epv188`.`parameterkey` = 188)))) left join `entityparametervalue` `epv189` on(((`e`.`pkey` = `epv189`.`entitykey`) and (`epv189`.`parameterkey` = 189)))) left join `entityparametervalue` `epv190` on(((`e`.`pkey` = `epv190`.`entitykey`) and (`epv190`.`parameterkey` = 190)))) left join `entityparametervalue` `epv191` on(((`e`.`pkey` = `epv191`.`entitykey`) and (`epv191`.`parameterkey` = 191)))) left join `entityparametervalue` `epv192` on(((`e`.`pkey` = `epv192`.`entitykey`) and (`epv192`.`parameterkey` = 192)))) left join `entityparametervalue` `epv193` on(((`e`.`pkey` = `epv193`.`entitykey`) and (`epv193`.`parameterkey` = 193)))) left join `entityparametervalue` `epv194` on(((`e`.`pkey` = `epv194`.`entitykey`) and (`epv194`.`parameterkey` = 194)))) left join `entityparametervalue` `epv195` on(((`e`.`pkey` = `epv195`.`entitykey`) and (`epv195`.`parameterkey` = 195)))) left join `entityparametervalue` `epv196` on(((`e`.`pkey` = `epv196`.`entitykey`) and (`epv196`.`parameterkey` = 196)))) left join `entityparametervalue` `epv197` on(((`e`.`pkey` = `epv197`.`entitykey`) and (`epv197`.`parameterkey` = 197)))) left join `entityparametervalue` `epv198` on(((`e`.`pkey` = `epv198`.`entitykey`) and (`epv198`.`parameterkey` = 198)))) left join `entityparametervalue` `epv199` on(((`e`.`pkey` = `epv199`.`entitykey`) and (`epv199`.`parameterkey` = 199)))) left join `entityparametervalue` `epv200` on(((`e`.`pkey` = `epv200`.`entitykey`) and (`epv200`.`parameterkey` = 200)))) left join `entityparametervalue` `epv201` on(((`e`.`pkey` = `epv201`.`entitykey`) and (`epv201`.`parameterkey` = 201)))) left join `entityparametervalue` `epv202` on(((`e`.`pkey` = `epv202`.`entitykey`) and (`epv202`.`parameterkey` = 202)))) left join `entityparametervalue` `epv203` on(((`e`.`pkey` = `epv203`.`entitykey`) and (`epv203`.`parameterkey` = 203)))) left join `entityparametervalue` `epv204` on(((`e`.`pkey` = `epv204`.`entitykey`) and (`epv204`.`parameterkey` = 204)))) left join `entityparametervalue` `epv205` on(((`e`.`pkey` = `epv205`.`entitykey`) and (`epv205`.`parameterkey` = 205)))) left join `entityparametervalue` `epv206` on(((`e`.`pkey` = `epv206`.`entitykey`) and (`epv206`.`parameterkey` = 206)))) left join `entityparametervalue` `epv207` on(((`e`.`pkey` = `epv207`.`entitykey`) and (`epv207`.`parameterkey` = 207)))) left join `entityparametervalue` `epv208` on(((`e`.`pkey` = `epv208`.`entitykey`) and (`epv208`.`parameterkey` = 208)))) left join `entityparametervalue` `epv209` on(((`e`.`pkey` = `epv209`.`entitykey`) and (`epv209`.`parameterkey` = 209)))) left join `entityparametervalue` `epv210` on(((`e`.`pkey` = `epv210`.`entitykey`) and (`epv210`.`parameterkey` = 210)))) left join `entityparametervalue` `epv211` on(((`e`.`pkey` = `epv211`.`entitykey`) and (`epv211`.`parameterkey` = 211)))) left join `entityparametervalue` `epv212` on(((`e`.`pkey` = `epv212`.`entitykey`) and (`epv212`.`parameterkey` = 212)))) left join `entityparametervalue` `epv213` on(((`e`.`pkey` = `epv213`.`entitykey`) and (`epv213`.`parameterkey` = 213)))) left join `entityparametervalue` `epv214` on(((`e`.`pkey` = `epv214`.`entitykey`) and (`epv214`.`parameterkey` = 214)))) left join `entityparametervalue` `epv215` on(((`e`.`pkey` = `epv215`.`entitykey`) and (`epv215`.`parameterkey` = 215)))) left join `entityparametervalue` `epv216` on(((`e`.`pkey` = `epv216`.`entitykey`) and (`epv216`.`parameterkey` = 216)))) left join `entityparametervalue` `epv217` on(((`e`.`pkey` = `epv217`.`entitykey`) and (`epv217`.`parameterkey` = 217)))) left join `entityparametervalue` `epv218` on(((`e`.`pkey` = `epv218`.`entitykey`) and (`epv218`.`parameterkey` = 218)))) where (`et`.`name` = 'DataPoint');

DROP VIEW IF EXISTS `datapoint_ev_02`;
CREATE VIEW  `datapoint_ev_02` AS select `e`.`pkey` AS `pkey`,`e`.`name` AS `name`,`sub`.`name` AS `subsysname`,`loc`.`name` AS `locationname`,`sereg`.`name` AS `regionname`,`et`.`name` AS `typename`,`sub2`.`name` AS `physicalname`,`e`.`name` AS `parentname`,`e`.`name` AS `agentname`,`scdata`.`name` AS `scsdatname`,`e`.`address` AS `ADDRESS`,`e`.`description` AS `DESCRIPTION`,`e`.`subsystemkey` AS `SUBSYSTEMKEY`,`e`.`locationkey` AS `LOCATIONKEY`,`e`.`seregi_id` AS `SEREGI_ID`,`e`.`typekey` AS `TYPEKEY`,`e`.`physical_subsystem_key` AS `PHYSICAL_SUBSYSTEM_KEY`,`e`.`scsdat_id` AS `SCSDAT_ID`,`e`.`parentkey` AS `PARENTKEY`,`e`.`agentkey` AS `AGENTKEY`,`e`.`deleted` AS `DELETED`,`epv219`.`value` AS `MANUALLYDRESSED`,`epv220`.`value` AS `MANUALLYDRESSEDVALUE`,`epv221`.`value` AS `DATATYPE`,`epv222`.`value` AS `ALARMINHIBITED`,`epv223`.`value` AS `MMSALARMINHIBITED`,`epv224`.`value` AS `MMSALARMPREVIOUSLYINHIBITED`,`epv225`.`value` AS `CONTROLINHIBITED`,`epv226`.`value` AS `STRUCTUREDNAME`,`epv227`.`value` AS `DISPLAYORDER`,`epv228`.`value` AS `UPDATEPRIORITY`,`epv229`.`value` AS `LOGCHANGES`,`epv230`.`value` AS `LAUNCHCONDITION`,`epv231`.`value` AS `LAUNCHRESULTSTRING`,`epv232`.`value` AS `RETURNCONDITION`,`epv233`.`value` AS `RETURNTIMEOUTINSEC`,`epv234`.`value` AS `MAXTEXTLENGTH`,`epv235`.`value` AS `CONTROLSTATUS`,`epv236`.`value` AS `LASTOPERATORSESSIONID`,`epv237`.`value` AS `LASTOPERATORTIMESTAMP`,`epv238`.`value` AS `FALSEALARMMMS`,`epv239`.`value` AS `TRUEALARMMMS`,`epv240`.`value` AS `LOALARMMMS`,`epv241`.`value` AS `HIALARMMMS`,`epv242`.`value` AS `LOLOALARMMMS`,`epv243`.`value` AS `HIHIALARMMMS`,`epv244`.`value` AS `CURRENTCONTROLREQUEST`,`epv245`.`value` AS `OMFLAG`,`epv246`.`value` AS `WORDSWAP`,`epv247`.`value` AS `CALCULATEDEXPRESSION`,`epv248`.`value` AS `MMSREPORTTYPE`,`epv249`.`value` AS `MMSREPORTPERIOD`,`epv250`.`value` AS `SWCADDRESS`,`epv251`.`value` AS `SCADASYSTEM`,`epv252`.`value` AS `INPUTDEPENDENCY`,`epv253`.`value` AS `LASTINPUTVALUE`,`epv254`.`value` AS `ACCUMULATEDINPUTVALUE`,`epv255`.`value` AS `ROLLOVERCONSTANT`,`epv256`.`value` AS `CORRECTIONVALUE`,`epv257`.`value` AS `METERFACTOR`,`epv258`.`value` AS `OVERSCALEHIALARMENABLED`,`epv259`.`value` AS `OVERSCALEHIALARMVALUE`,`epv260`.`value` AS `OVERSCALEHISEVERITY`,`epv261`.`value` AS `OVERSCALEHIALARMDELAY`,`epv262`.`value` AS `OVERSCALEHIALARMMESSAGE`,`epv263`.`value` AS `OVERSCALEHIALARMMMS`,`epv264`.`value` AS `OVERSCALELOALARMENABLED`,`epv265`.`value` AS `OVERSCALELOALARMVALUE`,`epv266`.`value` AS `OVERSCALELOSEVERITY`,`epv267`.`value` AS `OVERSCALELOALARMDELAY`,`epv268`.`value` AS `OVERSCALELOALARMMESSAGE`,`epv269`.`value` AS `OVERSCALELOALARMMMS`,`epv270`.`value` AS `DATAPOINTEVENTMESSAGE` from ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((`entity` `e` left join `entitytype` `et` on((`e`.`typekey` = `et`.`pkey`))) left join `subsystem` `sub` on((`e`.`subsystemkey` = `sub`.`pkey`))) left join `location` `loc` on((`e`.`locationkey` = `loc`.`pkey`))) left join `se_region` `sereg` on((`e`.`seregi_id` = `sereg`.`seregi_id`))) left join `subsystem` `sub2` on((`e`.`physical_subsystem_key` = `sub2`.`pkey`))) left join `entity` `ent1` on((`e`.`parentkey` = `ent1`.`pkey`))) left join `entity` `ent2` on((`e`.`agentkey` = `ent2`.`pkey`))) left join `sc_scada_datatypes` `scdata` on((`e`.`scsdat_id` = `scdata`.`scsdat_id`))) left join `entityparametervalue` `epv219` on(((`e`.`pkey` = `epv219`.`entitykey`) and (`epv219`.`parameterkey` = 219)))) left join `entityparametervalue` `epv220` on(((`e`.`pkey` = `epv220`.`entitykey`) and (`epv220`.`parameterkey` = 220)))) left join `entityparametervalue` `epv221` on(((`e`.`pkey` = `epv221`.`entitykey`) and (`epv221`.`parameterkey` = 221)))) left join `entityparametervalue` `epv222` on(((`e`.`pkey` = `epv222`.`entitykey`) and (`epv222`.`parameterkey` = 222)))) left join `entityparametervalue` `epv223` on(((`e`.`pkey` = `epv223`.`entitykey`) and (`epv223`.`parameterkey` = 223)))) left join `entityparametervalue` `epv224` on(((`e`.`pkey` = `epv224`.`entitykey`) and (`epv224`.`parameterkey` = 224)))) left join `entityparametervalue` `epv225` on(((`e`.`pkey` = `epv225`.`entitykey`) and (`epv225`.`parameterkey` = 225)))) left join `entityparametervalue` `epv226` on(((`e`.`pkey` = `epv226`.`entitykey`) and (`epv226`.`parameterkey` = 226)))) left join `entityparametervalue` `epv227` on(((`e`.`pkey` = `epv227`.`entitykey`) and (`epv227`.`parameterkey` = 227)))) left join `entityparametervalue` `epv228` on(((`e`.`pkey` = `epv228`.`entitykey`) and (`epv228`.`parameterkey` = 228)))) left join `entityparametervalue` `epv229` on(((`e`.`pkey` = `epv229`.`entitykey`) and (`epv229`.`parameterkey` = 229)))) left join `entityparametervalue` `epv230` on(((`e`.`pkey` = `epv230`.`entitykey`) and (`epv230`.`parameterkey` = 230)))) left join `entityparametervalue` `epv231` on(((`e`.`pkey` = `epv231`.`entitykey`) and (`epv231`.`parameterkey` = 231)))) left join `entityparametervalue` `epv232` on(((`e`.`pkey` = `epv232`.`entitykey`) and (`epv232`.`parameterkey` = 232)))) left join `entityparametervalue` `epv233` on(((`e`.`pkey` = `epv233`.`entitykey`) and (`epv233`.`parameterkey` = 233)))) left join `entityparametervalue` `epv234` on(((`e`.`pkey` = `epv234`.`entitykey`) and (`epv234`.`parameterkey` = 234)))) left join `entityparametervalue` `epv235` on(((`e`.`pkey` = `epv235`.`entitykey`) and (`epv235`.`parameterkey` = 235)))) left join `entityparametervalue` `epv236` on(((`e`.`pkey` = `epv236`.`entitykey`) and (`epv236`.`parameterkey` = 236)))) left join `entityparametervalue` `epv237` on(((`e`.`pkey` = `epv237`.`entitykey`) and (`epv237`.`parameterkey` = 237)))) left join `entityparametervalue` `epv238` on(((`e`.`pkey` = `epv238`.`entitykey`) and (`epv238`.`parameterkey` = 238)))) left join `entityparametervalue` `epv239` on(((`e`.`pkey` = `epv239`.`entitykey`) and (`epv239`.`parameterkey` = 239)))) left join `entityparametervalue` `epv240` on(((`e`.`pkey` = `epv240`.`entitykey`) and (`epv240`.`parameterkey` = 240)))) left join `entityparametervalue` `epv241` on(((`e`.`pkey` = `epv241`.`entitykey`) and (`epv241`.`parameterkey` = 241)))) left join `entityparametervalue` `epv242` on(((`e`.`pkey` = `epv242`.`entitykey`) and (`epv242`.`parameterkey` = 242)))) left join `entityparametervalue` `epv243` on(((`e`.`pkey` = `epv243`.`entitykey`) and (`epv243`.`parameterkey` = 243)))) left join `entityparametervalue` `epv244` on(((`e`.`pkey` = `epv244`.`entitykey`) and (`epv244`.`parameterkey` = 244)))) left join `entityparametervalue` `epv245` on(((`e`.`pkey` = `epv245`.`entitykey`) and (`epv245`.`parameterkey` = 245)))) left join `entityparametervalue` `epv246` on(((`e`.`pkey` = `epv246`.`entitykey`) and (`epv246`.`parameterkey` = 246)))) left join `entityparametervalue` `epv247` on(((`e`.`pkey` = `epv247`.`entitykey`) and (`epv247`.`parameterkey` = 247)))) left join `entityparametervalue` `epv248` on(((`e`.`pkey` = `epv248`.`entitykey`) and (`epv248`.`parameterkey` = 248)))) left join `entityparametervalue` `epv249` on(((`e`.`pkey` = `epv249`.`entitykey`) and (`epv249`.`parameterkey` = 249)))) left join `entityparametervalue` `epv250` on(((`e`.`pkey` = `epv250`.`entitykey`) and (`epv250`.`parameterkey` = 250)))) left join `entityparametervalue` `epv251` on(((`e`.`pkey` = `epv251`.`entitykey`) and (`epv251`.`parameterkey` = 251)))) left join `entityparametervalue` `epv252` on(((`e`.`pkey` = `epv252`.`entitykey`) and (`epv252`.`parameterkey` = 252)))) left join `entityparametervalue` `epv253` on(((`e`.`pkey` = `epv253`.`entitykey`) and (`epv253`.`parameterkey` = 253)))) left join `entityparametervalue` `epv254` on(((`e`.`pkey` = `epv254`.`entitykey`) and (`epv254`.`parameterkey` = 254)))) left join `entityparametervalue` `epv255` on(((`e`.`pkey` = `epv255`.`entitykey`) and (`epv255`.`parameterkey` = 255)))) left join `entityparametervalue` `epv256` on(((`e`.`pkey` = `epv256`.`entitykey`) and (`epv256`.`parameterkey` = 256)))) left join `entityparametervalue` `epv257` on(((`e`.`pkey` = `epv257`.`entitykey`) and (`epv257`.`parameterkey` = 257)))) left join `entityparametervalue` `epv258` on(((`e`.`pkey` = `epv258`.`entitykey`) and (`epv258`.`parameterkey` = 258)))) left join `entityparametervalue` `epv259` on(((`e`.`pkey` = `epv259`.`entitykey`) and (`epv259`.`parameterkey` = 259)))) left join `entityparametervalue` `epv260` on(((`e`.`pkey` = `epv260`.`entitykey`) and (`epv260`.`parameterkey` = 260)))) left join `entityparametervalue` `epv261` on(((`e`.`pkey` = `epv261`.`entitykey`) and (`epv261`.`parameterkey` = 261)))) left join `entityparametervalue` `epv262` on(((`e`.`pkey` = `epv262`.`entitykey`) and (`epv262`.`parameterkey` = 262)))) left join `entityparametervalue` `epv263` on(((`e`.`pkey` = `epv263`.`entitykey`) and (`epv263`.`parameterkey` = 263)))) left join `entityparametervalue` `epv264` on(((`e`.`pkey` = `epv264`.`entitykey`) and (`epv264`.`parameterkey` = 264)))) left join `entityparametervalue` `epv265` on(((`e`.`pkey` = `epv265`.`entitykey`) and (`epv265`.`parameterkey` = 265)))) left join `entityparametervalue` `epv266` on(((`e`.`pkey` = `epv266`.`entitykey`) and (`epv266`.`parameterkey` = 266)))) left join `entityparametervalue` `epv267` on(((`e`.`pkey` = `epv267`.`entitykey`) and (`epv267`.`parameterkey` = 267)))) left join `entityparametervalue` `epv268` on(((`e`.`pkey` = `epv268`.`entitykey`) and (`epv268`.`parameterkey` = 268)))) left join `entityparametervalue` `epv269` on(((`e`.`pkey` = `epv269`.`entitykey`) and (`epv269`.`parameterkey` = 269)))) left join `entityparametervalue` `epv270` on(((`e`.`pkey` = `epv270`.`entitykey`) and (`epv270`.`parameterkey` = 270)))) where (`et`.`name` = 'DataPoint');

DROP VIEW IF EXISTS `detailed_fault_view`;
CREATE VIEW  `detailed_fault_view` AS select `location`.`name` AS `Location`,`subsystem`.`name` AS `subsystem`,`physicalsubsystem`.`name` AS `physical_subsystem`,str_to_date(`alarm`.`sourcetime`,'%Y-%m-%d %H:%i:%s') AS `Date_Time`,`alarm`.`asset_name` AS `asset`,(case `entityparametervalue_v3`.`VALUE` when 'NA' then substr(`entityparent`.`name`,9) else `entityparametervalue_v3`.`VALUE` end) AS `equipment_description`,`entity`.`description` AS `point_description`,substr(`alarm`.`param_list`,(locate('DataPointValue',`alarm`.`param_list`) + 15),((locate(',',`alarm`.`param_list`,locate('DataPointValue',`alarm`.`param_list`)) - locate('DataPointValue',`alarm`.`param_list`)) - 15)) AS `VALUE`,`alarmseverity`.`name` AS `Severity`,(case `alarm`.`mms_state_type` when 0 then '' when 1 then 'S' when 2 then 'A' when 3 then 'R' when 4 then '' when 5 then 'I' when 6 then 'D' else NULL end) AS `MMS`,`alarm`.`comments` AS `comments` from (((((((`alarm` join `entity`) join `alarmseverity`) join `subsystem`) join `subsystem` `physicalsubsystem`) join `entity` `entityparent`) join `location`) join `entityparametervalue_v` `entityparametervalue_v3`) where ((`alarm`.`entitykey` = `entity`.`pkey`) and (`alarmseverity`.`pkey` = `alarm`.`severity`) and (`subsystem`.`pkey` = `entity`.`subsystemkey`) and (`physicalsubsystem`.`pkey` = `entity`.`physical_subsystem_key`) and (`entityparent`.`pkey` = `entity`.`parentkey`) and (`location`.`pkey` = `entity`.`locationkey`) and (`entityparametervalue_v3`.`PARAMETERNAME` = 'Label') and (`entityparametervalue_v3`.`ENTITYKEY` = `entityparent`.`pkey`));

DROP VIEW IF EXISTS `dp_is_manually_dressed_v`;
CREATE VIEW  `dp_is_manually_dressed_v` AS select `e`.`pkey` AS `entity_pkey`,`e`.`name` AS `entity_name`,`epv`.`value` AS `manually_dressed_value` from (((`entity` `e` join `entitytype` `et`) join `entityparameter` `ep`) join `entityparametervalue` `epv`) where ((`e`.`typekey` = `et`.`pkey`) and (`e`.`pkey` = `epv`.`entitykey`) and (`ep`.`pkey` = `epv`.`parameterkey`) and (`et`.`pkey` = `ep`.`typekey`) and (ucase(`ep`.`name`) = 'MANUALLYDRESSEDVALUE') and `e`.`pkey` in (select `e`.`pkey` from (((`entity` `e` join `entitytype` `et`) join `entityparameter` `ep`) join `entityparametervalue` `epv`) where ((`e`.`typekey` = `et`.`pkey`) and (`e`.`pkey` = `epv`.`entitykey`) and (`ep`.`pkey` = `epv`.`parameterkey`) and (`et`.`pkey` = `ep`.`typekey`) and (ucase(`et`.`name`) = 'DATAPOINT') and (ucase(`ep`.`name`) = 'MANUALLYDRESSED') and (ucase(`epv`.`value`) = 'TRUE'))));

DROP VIEW IF EXISTS `dr_datapoint_12min_view`;
CREATE VIEW  `dr_datapoint_12min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int12min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int12min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_1min_view`;
CREATE VIEW  `dr_datapoint_1min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int1min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int1min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_2min_view`;
CREATE VIEW  `dr_datapoint_2min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int2min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int2min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_3min_view`;
CREATE VIEW  `dr_datapoint_3min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int3min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int3min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_4min_view`;
CREATE VIEW  `dr_datapoint_4min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int4min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int4min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_5min_view`;
CREATE VIEW  `dr_datapoint_5min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int5min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int5min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_6min_view`;
CREATE VIEW  `dr_datapoint_6min_view` AS select `t2`.`sourcedate` AS `sourcedate`,`t1`.`startsecond` AS `startsecond`,`t1`.`int6min` AS `endsecond`,(`t2`.`sourcedate` + (`t1`.`startsecond` / 86400)) AS `startdatetime`,(`t2`.`sourcedate` + (`t1`.`endsecond` / 86400)) AS `enddatetime`,`t3`.`ENTITYKEY` AS `entitykey`,(select max(`dr_datapoint_data`.`value`) from `dr_datapoint_data` where ((`dr_datapoint_data`.`sourcedate` = `t2`.`sourcedate`) and (`dr_datapoint_data`.`timeofday` between `t1`.`startsecond` and `t1`.`endsecond`) and (`dr_datapoint_data`.`entitykey` = `t3`.`ENTITYKEY`) and `dr_datapoint_data`.`timeofday` in (select max(`dr_datapoint_data`.`timeofday`) from `dr_datapoint_data`))) AS `iavg` from ((`dr_trend_interval` `t1` join `entityparametervalue_v` `t3`) join `dr_datapoint_date` `t2`) where ((`t1`.`int6min` > 0) and (`t3`.`TYPENAME` like 'DataPoint') and (`t3`.`PARAMETERNAME` = 'EnableTrending') and (`t3`.`VALUE` = '1'));

DROP VIEW IF EXISTS `dr_datapoint_real_view`;
CREATE VIEW  `dr_datapoint_real_view` AS select `dr_datapoint_data`.`sourcedate` AS `sourcedate`,`dr_datapoint_data`.`timeofday` AS `startsecond`,`dr_datapoint_data`.`timeofday` AS `endsecond`,`dr_datapoint_data`.`sourcetime` AS `startdatetime`,`dr_datapoint_data`.`sourcetime` AS `enddatetime`,`dr_datapoint_data`.`entitykey` AS `entitykey`,`dr_datapoint_data`.`value` AS `iavg` from `dr_datapoint_data`;

DROP VIEW IF EXISTS `dr_mmsinhibit_summary_view`;
CREATE VIEW  `dr_mmsinhibit_summary_view` AS select `drdns`.`updatetime` AS `Date_Time`,`ope`.`description` AS `ope`,`pro`.`name` AS `op_profile`,`sub`.`name` AS `sub`,`e`.`name` AS `DATANODE`,(case `drdns`.`inhibitmms` when 1 then 'MMSInhibit' else 'Noninhibit' end) AS `Status`,`loc`.`name` AS `LOCATION` from ((((`dr_datanode_state` `drdns` left join (`ta_session` `tasess` left join `operator` `ope` on((`tasess`.`operatorkey` = `ope`.`pkey`))) on((`drdns`.`lastoperatorsessionid` = `tasess`.`pkey`))) left join (`entity` `e` left join `subsystem` `sub` on((`e`.`physical_subsystem_key` = `sub`.`pkey`))) on((`e`.`pkey` = `drdns`.`entitykey`))) join `location` `loc`) join `se_profile` `pro`) where ((`tasess`.`seprof_id` = `pro`.`seprof_id`) and (`e`.`locationkey` = `loc`.`pkey`) and (`drdns`.`inhibitmms` <> '') and (`drdns`.`inhibitmms` <> 0));

DROP VIEW IF EXISTS `dr_plcfailure_status_view`;
CREATE VIEW  `dr_plcfailure_status_view` AS select `dt`.`sourcetime` AS `sourcetime`,substr(`n`.`name`,13) AS `plc_number`,`l`.`name` AS `location`,`l`.`order_id` AS `location_order`,(case `e`.`description` when 'MUX 1 Input Card 1 Reading Status' then `dt`.`value` else NULL end) AS `mux1_input_card_reading_status`,(case `e`.`description` when 'MUX 1 Selection Status' then `dt`.`value` else NULL end) AS `mux1_selection_status`,(case `e`.`description` when 'PLC Power Card Status' then `dt`.`value` else NULL end) AS `plc_power_card_status`,(case `e`.`description` when 'PLC CPU Card Status' then `dt`.`value` else NULL end) AS `plc_cpu_card_status`,(case `e`.`description` when 'MUX 1 Input Card Status' then `dt`.`value` else NULL end) AS `mux1_input_card_status`,(case `e`.`description` when 'MUX 1 Output Card Status' then `dt`.`value` else NULL end) AS `mux1_output_card_status`,(case `e`.`description` when 'DO 1 Card Status' then `dt`.`value` else NULL end) AS `do1_card_status`,(case `e`.`description` when 'DO 2 Card Status' then `dt`.`value` else NULL end) AS `do2_card_status`,(case `e`.`description` when 'DO 3 Card Status' then `dt`.`value` else NULL end) AS `do3_card_status`,(case `e`.`description` when 'DO 4 Card Status' then `dt`.`value` else NULL end) AS `do4_card_status`,(case `e`.`description` when 'MI 1 Card Status' then `dt`.`value` else NULL end) AS `mi1_card_status`,(case `e`.`description` when 'MI 2 Card Status' then `dt`.`value` else NULL end) AS `mi2_card_status`,(case `e`.`description` when 'DI 1 Card Status' then `dt`.`value` else NULL end) AS `di1_card_status`,(case `e`.`description` when 'Battery Status' then `dt`.`value` else NULL end) AS `battery_status` from (((`dr_datapoint_data` `dt` join `entity` `e`) join `entity` `n`) join `location` `l`) where (`dt`.`entitykey` in (select `e`.`pkey` from `entity` `e` where ((`e`.`name` like '%VersionNumber%') or (`e`.`name` like '%ConfigType%') or (`e`.`name` like '%MUX1Input1Read%') or (`e`.`name` like '%MUX1Select%') or (`e`.`name` like '%PowerCard%') or (`e`.`name` like '%CPUFaultNormal%') or (`e`.`name` like '%MUX1InputFaultNormal%') or (`e`.`name` like '%MUX1Output%') or (`e`.`name` like '%DO1%') or (`e`.`name` like '%DO2%') or (`e`.`name` like '%DO3%') or (`e`.`name` like '%DO4%') or (`e`.`name` like '%MI1%') or (`e`.`name` like '%MI2%') or (`e`.`name` like '%DI1%') or (`e`.`name` like '%Battery%'))) and (`dt`.`entitykey` = `e`.`pkey`) and (`e`.`locationkey` = `l`.`pkey`) and (`n`.`pkey` = `e`.`parentkey`) and (`dt`.`value` = 0)) order by `l`.`order_id`;

DROP VIEW IF EXISTS `dr_plcstatus_view`;
CREATE VIEW  `dr_plcstatus_view` AS select `dt`.`sourcetime` AS `SOURCETIME`,substr(`n`.`name`,13) AS `PLC_NUMBER`,`l`.`name` AS `LOCATION`,`l`.`order_id` AS `location_order`,(case `e`.`description` when 'PLC Version Number' then `dt`.`value` else NULL end) AS `Version_Number`,(case `e`.`description` when 'PLC Config Type' then `dt`.`value` else NULL end) AS `Config_Type`,(case `e`.`description` when 'MUX 1 Input Card 1 Reading Status' then `dt`.`value` else NULL end) AS `MUX1_Input_Card_Reading_Status`,(case `e`.`description` when 'MUX 1 Selection Status' then `dt`.`value` else NULL end) AS `MUX1_Selection_Status`,(case `e`.`description` when 'PLC Power Card Status' then `dt`.`value` else NULL end) AS `PLC_Power_Card_Status`,(case `e`.`description` when 'PLC CPU Card Status' then `dt`.`value` else NULL end) AS `PLC_CPU_Card_Status`,(case `e`.`description` when 'MUX 1 Input Card Status' then `dt`.`value` else NULL end) AS `MUX1_Input_Card_Status`,(case `e`.`description` when 'MUX 1 Output Card Status' then `dt`.`value` else NULL end) AS `MUX1_Output_Card_Status`,(case `e`.`description` when 'DO 1 Card Status' then `dt`.`value` else NULL end) AS `DO1_Card_Status`,(case `e`.`description` when 'DO 2 Card Status' then `dt`.`value` else NULL end) AS `DO2_Card_Status`,(case `e`.`description` when 'DO 3 Card Status' then `dt`.`value` else NULL end) AS `DO3_Card_Status`,(case `e`.`description` when 'DO 4 Card Status' then `dt`.`value` else NULL end) AS `DO4_Card_Status`,(case `e`.`description` when 'MI 1 Card Status' then `dt`.`value` else NULL end) AS `MI1_Card_Status`,(case `e`.`description` when 'MI 2 Card Status' then `dt`.`value` else NULL end) AS `MI2_Card_Status`,(case `e`.`description` when 'DI 1 Card Status' then `dt`.`value` else NULL end) AS `DI1_Card_Status`,(case `e`.`description` when 'Battery Status' then `dt`.`value` else NULL end) AS `Battery_Status` from (((`dr_datapoint_state` `dt` join `entity` `e`) join `entity` `n`) join `location` `l`) where (`dt`.`entitykey` in (select `e`.`pkey` from `entity` `e` where ((`e`.`name` like '%PLC%VersionNumber%') or (`e`.`name` like '%PLC%ConfigType%') or (`e`.`name` like '%PLC%MUX1Input1Read%') or (`e`.`name` like '%PLC%MUX1Select%') or (`e`.`name` like '%PLC%PowerCard%') or (`e`.`name` like '%PLC%CPUFaultNormal%') or (`e`.`name` like '%PLC%MUX1InputFaultNormal%') or (`e`.`name` like '%PLC%MUX1Output%') or (`e`.`name` like '%PLC%DO1%') or (`e`.`name` like '%PLC%DO2%') or (`e`.`name` like '%PLC%DO3%') or (`e`.`name` like '%PLC%DO4%') or (`e`.`name` like '%PLC%MI1%') or (`e`.`name` like '%PLC%MI2%') or (`e`.`name` like '%PLC%DI2%') or (`e`.`name` like '%PLC%Battery%'))) and (`dt`.`entitykey` = `e`.`pkey`) and (`e`.`locationkey` = `l`.`pkey`) and (`n`.`pkey` = `e`.`parentkey`) and (`dt`.`value` <> '')) order by substr(`n`.`name`,13),`l`.`order_id`,`dt`.`sourcetime` desc;

DROP VIEW IF EXISTS `dr_pwrdmd_1day_view`;
CREATE VIEW  `dr_pwrdmd_1day_view` AS select concat(date_format(sysdate(),'%H-%m-%Y'),' ','00:00:00') AS `start_interval`,concat(date_format((sysdate() + interval 24 day),'%H-%m-%Y'),' ','00:00:00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,sum(`dt`.`demand`) AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%miiPWRC-ActPowCons%') and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) group by `l`.`name`,`dt`.`entitykey`,`e`.`pkey` union select concat(date_format(sysdate(),'%H-%m-%Y'),' ','00:00:00') AS `start_interval`,concat(date_format((sysdate() + interval 24 day),'%H-%m-%Y'),' ','00:00:00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,0 AS `act_demand`,sum(`dt`.`demand`) AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-ReacPowCons%') and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) group by `l`.`name`,`dt`.`entitykey`,`e`.`pkey` union select concat(date_format(sysdate(),'%H-%m-%Y'),' ','00:00:00') AS `start_interval`,concat(date_format((sysdate() + interval 24 day),'%H-%m-%Y'),' ','00:00:00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,0 AS `act_demand`,0 AS `react_demand`,sum(`dt`.`demand`) AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-PowConsumed%') and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) group by `l`.`name`,`dt`.`entitykey`,`e`.`pkey` union select concat(date_format(sysdate(),'%H-%m-%Y'),' ','00:00:00') AS `start_interval`,concat(date_format((sysdate() + interval 24 day),'%H-%m-%Y'),' ','00:00:00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,sum(`dt`.`demand`) AS `regeneration_demand`,0 AS `service_demand` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-PowGen') and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) group by `l`.`name`,`dt`.`entitykey`,`e`.`pkey` union select concat(date_format(sysdate(),'%H-%m-%Y'),' ','00:00:00') AS `start_interval`,concat(date_format((sysdate() + interval 24 day),'%H-%m-%Y'),' ','00:00:00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,sum(`dt`.`demand`) AS `service_demand` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiMCC-KWH_') and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) group by `l`.`name`,`dt`.`entitykey`,`e`.`pkey`;

DROP VIEW IF EXISTS `dr_pwrdmd_30min_view`;
CREATE VIEW  `dr_pwrdmd_30min_view` AS select concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor(((`dt`.`int` - 1) / 2)),':',convert((case ((`dt`.`int` / 2) - floor((`dt`.`int` / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `start_interval`,concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor((`dt`.`int` / 2)),':',convert((case (((`dt`.`int` - 1) / 2) - floor(((`dt`.`int` - 1) / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`sourcedate` AS `SOURCEDATE`,`dt`.`int` AS `int`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,`dt`.`demand` AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%miiPWRC-ActPowCons%') and (`dt`.`int` = floor((((((cast(hour(sysdate()) as unsigned) * 60) + cast(minute(sysdate()) as unsigned)) * 60) / 1800) + 1))) and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) union select concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor(((`dt`.`int` - 1) / 2)),':',convert((case ((`dt`.`int` / 2) - floor((`dt`.`int` / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `start_interval`,concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor((`dt`.`int` / 2)),':',convert((case (((`dt`.`int` - 1) / 2) - floor(((`dt`.`int` - 1) / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`sourcedate` AS `SOURCEDATE`,`dt`.`int` AS `int`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,`dt`.`demand` AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-ReacPowCons%') and (`dt`.`int` = floor((((((cast(hour(sysdate()) as unsigned) * 60) + cast(minute(sysdate()) as unsigned)) * 60) / 1800) + 1))) and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) union select concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor(((`dt`.`int` - 1) / 2)),':',convert((case ((`dt`.`int` / 2) - floor((`dt`.`int` / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `start_interval`,concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor((`dt`.`int` / 2)),':',convert((case (((`dt`.`int` - 1) / 2) - floor(((`dt`.`int` - 1) / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`sourcedate` AS `SOURCEDATE`,`dt`.`int` AS `int`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_react_demand`,`dt`.`demand` AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-PowConsumed%') and (`dt`.`int` = floor((((((cast(hour(sysdate()) as unsigned) * 60) + cast(minute(sysdate()) as unsigned)) * 60) / 1800) + 1))) and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) union select concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor(((`dt`.`int` - 1) / 2)),':',convert((case ((`dt`.`int` / 2) - floor((`dt`.`int` / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `start_interval`,concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor((`dt`.`int` / 2)),':',convert((case (((`dt`.`int` - 1) / 2) - floor(((`dt`.`int` - 1) / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`sourcedate` AS `SOURCEDATE`,`dt`.`int` AS `int`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,`dt`.`demand` AS `regeneration_demand`,0 AS `service_demand`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-PowGen') and (`dt`.`int` = floor((((((cast(hour(sysdate()) as unsigned) * 60) + cast(minute(sysdate()) as unsigned)) * 60) / 1800) + 1))) and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`)) union select concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor(((`dt`.`int` - 1) / 2)),':',convert((case ((`dt`.`int` / 2) - floor((`dt`.`int` / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `start_interval`,concat(date_format(sysdate(),'%H-%m-%Y'),' ',floor((`dt`.`int` / 2)),':',convert((case (((`dt`.`int` - 1) / 2) - floor(((`dt`.`int` - 1) / 2))) when 0 then '30' else '00' end) using utf8),':','00') AS `end_interval`,`l`.`name` AS `location`,`dt`.`sourcedate` AS `SOURCEDATE`,`dt`.`int` AS `int`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,`dt`.`demand` AS `service_demand`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiMCC-KWH_') and (`dt`.`int` = floor((((((cast(hour(sysdate()) as unsigned) * 60) + cast(minute(sysdate()) as unsigned)) * 60) / 1800) + 1))) and (`dt`.`sourcedate` >= curdate()) and (`dt`.`sourcedate` < (curdate() + interval 1 day)) and (`e`.`locationkey` = `l`.`pkey`));

DROP VIEW IF EXISTS `dr_pwrdmd_30min_view1`;
CREATE VIEW  `dr_pwrdmd_30min_view1` AS select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,`dt`.`demand` AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%miiPWRC-ActPowCons%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,`dt`.`demand` AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-ReacPowCons%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_react_demand`,`dt`.`demand` AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%RF5__.mii%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,`dt`.`demand` AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%IV60_.mii%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,`dt`.`demand` AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%LM_01%.mii%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,`dt`.`demand` AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%HM10_%.miiPWRC-ActPowCons%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,`dt`.`demand` AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%KWT%mii%') and (`e`.`locationkey` = `l`.`pkey`)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,`dt`.`demand` AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME`,`dt`.`demand` AS `demand`,`l`.`pkey` AS `LOCKEY` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiMCC-KWH_') and (`e`.`locationkey` = `l`.`pkey`));

DROP VIEW IF EXISTS `dr_pwrdmd_data_v`;
CREATE VIEW  `dr_pwrdmd_data_v` AS select `pd`.`entitykey` AS `entitykey`,`pc`.`setpoint` AS `setpoint`,`pc`.`tariff` AS `tariff`,`pc`.`location` AS `location` from ((`dr_pwrdmd_data` `pd` join `dr_pwrdmd_config` `pc`) join `entity` `e`) where ((`pd`.`entitykey` = `e`.`pkey`) and (`e`.`locationkey` = `pc`.`locationkey`));

DROP VIEW IF EXISTS `dr_pwrdmd_day_sum_view`;
CREATE VIEW  `dr_pwrdmd_day_sum_view` AS select max(cast(`dr_pwrdmd_30min_view1`.`start_interval` as date)) AS `dmd_date`,max(`dr_pwrdmd_30min_view1`.`location`) AS `location`,(sum(`dr_pwrdmd_30min_view1`.`consumption_demand`) / 2000) AS `on_traction`,(sum(`dr_pwrdmd_30min_view1`.`regeneration_demand`) / 2000) AS `on_regen`,(sum(`dr_pwrdmd_30min_view1`.`service_demand`) / 2000) AS `on_service`,(sum(`dr_pwrdmd_30min_view1`.`pl_demand`) / 2000) AS `on_pl`,(sum(`dr_pwrdmd_30min_view1`.`ecs_demand`) / 2000) AS `on_ecs`,(max(`dr_pwrdmd_30min_view1`.`demand`) / 1000) AS `on_max_demand`,0 AS `off_traction`,0 AS `off_regen`,0 AS `off_service`,0 AS `off_pl`,0 AS `off_ecs`,0 AS `off_max_demand`,1 AS `tariff` from `dr_pwrdmd_30min_view1` where (`dr_pwrdmd_30min_view1`.`TARIFF` = 1) group by `dr_pwrdmd_30min_view1`.`location`,cast(`dr_pwrdmd_30min_view1`.`start_interval` as date) union select max(cast(`dr_pwrdmd_30min_view1`.`start_interval` as date)) AS `dmd_date`,max(`dr_pwrdmd_30min_view1`.`location`) AS `location`,0 AS `on_traction`,0 AS `on_regen`,0 AS `on_service`,0 AS `on_pl`,0 AS `on_ecs`,0 AS `on_max_demand`,(sum(`dr_pwrdmd_30min_view1`.`consumption_demand`) / 2000) AS `off_traction`,(sum(`dr_pwrdmd_30min_view1`.`regeneration_demand`) / 2000) AS `off_regen`,(sum(`dr_pwrdmd_30min_view1`.`service_demand`) / 2000) AS `off_service`,(sum(`dr_pwrdmd_30min_view1`.`pl_demand`) / 2000) AS `off_pl`,(sum(`dr_pwrdmd_30min_view1`.`ecs_demand`) / 2000) AS `off_ecs`,(max(`dr_pwrdmd_30min_view1`.`demand`) / 1000) AS `off_max_demand`,0 AS `tariff` from `dr_pwrdmd_30min_view1` where (`dr_pwrdmd_30min_view1`.`TARIFF` = 0) group by `dr_pwrdmd_30min_view1`.`location`,cast(`dr_pwrdmd_30min_view1`.`start_interval` as date);

DROP VIEW IF EXISTS `dr_pwrdmd_daymax_02_view`;
CREATE VIEW  `dr_pwrdmd_daymax_02_view` AS (select cast(`v2`.`start_interval` as date) AS `day`,max(`v2`.`demand`) AS `maxdemand`,min(`v2`.`location`) AS `loc` from `dr_pwrdmd_30min_view1` `v2` where (`v2`.`TARIFF` = 1) group by `v2`.`location`,cast(`v2`.`start_interval` as date));

DROP VIEW IF EXISTS `dr_pwrdmd_daymax_view`;
CREATE VIEW  `dr_pwrdmd_daymax_view` AS select cast(`v1`.`start_interval` as date) AS `day`,max(`v1`.`location`) AS `location`,max(`v1`.`demand`) AS `ON_max_demand`,min(date_format(`v1`.`start_interval`,'%Y/%m/%d %H:%i:%s')) AS `ON_max_demand_time`,0 AS `off_max_demand`,'1900' AS `off_max_demand_time`,1 AS `tariff` from (`dr_pwrdmd_30min_view1` `v1` join `dr_pwrdmd_daymax_02_view` `ds` on(((`v1`.`start_interval` >= `ds`.`day`) and (`v1`.`start_interval` < (`ds`.`day` + interval 1 day)) and (`v1`.`demand` = `ds`.`maxdemand`) and (`v1`.`location` = `ds`.`loc`)))) where (`v1`.`TARIFF` = 1) group by `v1`.`location`,cast(`v1`.`start_interval` as date) union select cast(`v1`.`start_interval` as date) AS `day`,max(`v1`.`location`) AS `location`,0 AS `on_max_demand`,'1900' AS `on_max_demand_time`,max(`v1`.`demand`) AS `OFF_max_demand`,min(date_format(`v1`.`start_interval`,'%Y/%m/%d %H:%i:%s')) AS `OFF_max_demand_time`,0 AS `tariff` from (`dr_pwrdmd_30min_view1` `v1` join `dr_pwrdmd_daymax_02_view` `ds` on(((`v1`.`start_interval` >= `ds`.`day`) and (`v1`.`start_interval` < (`ds`.`day` + interval 1 day)) and (`v1`.`demand` = `ds`.`maxdemand`) and (`v1`.`location` = `ds`.`loc`)))) where (`v1`.`TARIFF` = 0) group by `v1`.`location`,cast(`v1`.`start_interval` as date);

DROP VIEW IF EXISTS `dr_pwrdmd_daysum_view`;
CREATE VIEW  `dr_pwrdmd_daysum_view` AS select distinct cast(`dr_pwrdmd_30min_view1`.`start_interval` as date) AS `pwrday` from `dr_pwrdmd_30min_view1`;

DROP VIEW IF EXISTS `dr_pwrdmd_hoursum_view`;
CREATE VIEW  `dr_pwrdmd_hoursum_view` AS select distinct hour(`dr_pwrdmd_30min_table`.`sourcedate`) AS `hour_date` from `dr_pwrdmd_30min_table`;

DROP VIEW IF EXISTS `dr_pwrdmd_monthsum_view`;
CREATE VIEW  `dr_pwrdmd_monthsum_view` AS select distinct minute(`dr_pwrdmd_30min_table`.`sourcedate`) AS `pwrmonth` from `dr_pwrdmd_30min_table`;

DROP VIEW IF EXISTS `off_peak_dr_pwrdmd_30min_view`;
CREATE VIEW  `off_peak_dr_pwrdmd_30min_view` AS select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,`dt`.`demand` AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%miiPWRC-ActPowCons%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,`dt`.`demand` AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-ReacPowCons%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_react_demand`,`dt`.`demand` AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%RF5__.mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,`dt`.`demand` AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%IV60_.mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,`dt`.`demand` AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%LM_01%.mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,`dt`.`demand` AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%HM10_%.miiPWRC-ActPowCons%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,`dt`.`demand` AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%KWT%mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,`dt`.`demand` AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiMCC-KWH_') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 0));

DROP VIEW IF EXISTS `on_peak_dr_pwrdmd_30min_view`;
CREATE VIEW  `on_peak_dr_pwrdmd_30min_view` AS select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,`dt`.`demand` AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%miiPWRC-ActPowCons%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,`dt`.`demand` AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiPWRC-ReacPowCons%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_react_demand`,`dt`.`demand` AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%RF5__.mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,`dt`.`demand` AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%IV60_.mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,`dt`.`demand` AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%LM_01%.mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,`dt`.`demand` AS `intake_demand`,0 AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%HM10_%.miiPWRC-ActPowCons%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,`dt`.`demand` AS `pl_demand`,0 AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%KWT%mii%') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1)) union select `dt`.`sourcedate` AS `start_interval`,(`dt`.`sourcedate` + interval 30 minute) AS `end_interval`,(`dt`.`sourcedate` + interval 1799 second) AS `rep_timestamp`,`l`.`name` AS `location`,`dt`.`entitykey` AS `ENTITYKEY`,`dt`.`tariff` AS `TARIFF`,0 AS `act_demand`,0 AS `react_demand`,0 AS `consumption_demand`,0 AS `regeneration_demand`,0 AS `service_demand`,0 AS `intake_demand`,0 AS `pl_demand`,`dt`.`demand` AS `ecs_demand`,`dt`.`edited_demand` AS `EDITED_DEMAND`,`dt`.`setpoint` AS `SETPOINT`,`dt`.`setpoint_name` AS `SETPOINT_NAME` from ((`dr_pwrdmd_30min_table` `dt` join `entity` `e`) join `location` `l`) where ((`dt`.`entitykey` = `e`.`pkey`) and (`e`.`name` like '%.miiMCC-KWH_') and (`e`.`locationkey` = `l`.`pkey`) and (`dt`.`tariff` = 1));


DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_off_dt2_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_off_dt2_v` AS select `off_dpv`.`location` AS `LOCATION`,max(`off_dpv`.`intake_demand`) AS `maxdemand1` from `off_peak_dr_pwrdmd_30min_view` `off_dpv` group by `off_dpv`.`location`;

DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_off_dt3_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_off_dt3_v` AS select `off_dt1`.`location` AS `LOCATION`,`off_dt1`.`rep_timestamp` AS `rep_timestamp`,`off_dt1`.`intake_demand` AS `intake_demand` from (`off_peak_dr_pwrdmd_30min_view` `off_dt1` join `dr_pwrdmd_overall_summary_off_dt2_v` `off_dt2`) where ((`off_dt1`.`location` = `off_dt2`.`LOCATION`) and (`off_dt1`.`intake_demand` = `off_dt2`.`maxdemand1`));

DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_off_maxdemand_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_off_maxdemand_v` AS select `off_dt3`.`LOCATION` AS `off_loc`,min(`off_dt3`.`rep_timestamp`) AS `off_maxdatetime`,max(`off_dt3`.`intake_demand`) AS `off_maxdemand` from `dr_pwrdmd_overall_summary_off_dt3_v` `off_dt3` group by `off_dt3`.`LOCATION`;

DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_on_dt2_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_on_dt2_v` AS select `on_peak_dr_pwrdmd_30min_view`.`location` AS `LOCATION`,max(`on_peak_dr_pwrdmd_30min_view`.`intake_demand`) AS `maxdemand` from `on_peak_dr_pwrdmd_30min_view` group by `on_peak_dr_pwrdmd_30min_view`.`location`;

DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_on_dt3_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_on_dt3_v` AS select `dt1`.`location` AS `LOCATION`,`dt1`.`rep_timestamp` AS `rep_timestamp`,`dt1`.`intake_demand` AS `intake_demand` from (`on_peak_dr_pwrdmd_30min_view` `dt1` join `dr_pwrdmd_overall_summary_on_dt2_v` `dt2` on(((`dt1`.`location` = `dt2`.`LOCATION`) and (`dt1`.`intake_demand` = `dt2`.`maxdemand`))));

DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_on_maxdemand_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_on_maxdemand_v` AS select `dt3`.`LOCATION` AS `on_loc`,min(`dt3`.`rep_timestamp`) AS `on_maxdatetime`,max(`dt3`.`intake_demand`) AS `on_maxdemand` from `dr_pwrdmd_overall_summary_on_dt3_v` `dt3` group by `dt3`.`LOCATION`;

DROP VIEW IF EXISTS `dr_pwrdmd_overall_summary_v`;
CREATE VIEW  `dr_pwrdmd_overall_summary_v` AS select `dv1`.`start_interval` AS `start_interval`,`dv1`.`end_interval` AS `end_interval`,`dv1`.`rep_timestamp` AS `rep_timestamp`,`dv1`.`location` AS `location`,`dv1`.`ENTITYKEY` AS `ENTITYKEY`,`dv1`.`TARIFF` AS `TARIFF`,`dv1`.`act_demand` AS `act_demand`,`dv1`.`react_demand` AS `react_demand`,`dv1`.`consumption_demand` AS `consumption_demand`,`dv1`.`regeneration_demand` AS `regeneration_demand`,`dv1`.`service_demand` AS `service_demand`,`dv1`.`intake_demand` AS `intake_demand`,`dv1`.`pl_demand` AS `pl_demand`,`dv1`.`ecs_demand` AS `ecs_demand`,`dv1`.`EDITED_DEMAND` AS `EDITED_DEMAND`,`dv1`.`SETPOINT` AS `SETPOINT`,`dv1`.`SETPOINT_NAME` AS `SETPOINT_NAME`,`dv1`.`demand` AS `demand`,`dv1`.`LOCKEY` AS `LOCKEY`,`max_demand`.`on_loc` AS `on_loc`,`max_demand`.`on_maxdatetime` AS `on_maxdatetime`,`max_demand`.`on_maxdemand` AS `on_maxdemand`,`off_maxdemand`.`off_loc` AS `off_loc`,`off_maxdemand`.`off_maxdatetime` AS `off_maxdatetime`,`off_maxdemand`.`off_maxdemand` AS `off_maxdemand` from ((`dr_pwrdmd_30min_view1` `dv1` left join `dr_pwrdmd_overall_summary_on_maxdemand_v` `max_demand` on((`dv1`.`location` = `max_demand`.`on_loc`))) left join `dr_pwrdmd_overall_summary_off_maxdemand_v` `off_maxdemand` on((`dv1`.`location` = `off_maxdemand`.`off_loc`)));

DROP VIEW IF EXISTS `dr_pwrdmd_weeksum_view`;
CREATE VIEW  `dr_pwrdmd_weeksum_view` AS select distinct floor(((to_days(`dr_pwrdmd_30min_table`.`sourcedate`) - to_days(str_to_date('02/01/2000 00:00:00','%d/%m/%Y %H:%i:%s'))) / 7)) AS `pwrweek` from `dr_pwrdmd_30min_table`;

DROP VIEW IF EXISTS `dr_pwrdmd_yearmax_tiff0_view`;
CREATE VIEW  `dr_pwrdmd_yearmax_tiff0_view` AS (select cast(`v2`.`start_interval` as date) AS `day`,max(`v2`.`demand`) AS `maxdemand`,min(`v2`.`location`) AS `loc` from `dr_pwrdmd_30min_view1` `v2` where (`v2`.`TARIFF` = 0) group by `v2`.`location`,cast(`v2`.`start_interval` as date));

DROP VIEW IF EXISTS `dr_pwrdmd_yearmax_tiff1_view`;
CREATE VIEW  `dr_pwrdmd_yearmax_tiff1_view` AS (select cast(`v2`.`start_interval` as date) AS `day`,max(`v2`.`demand`) AS `maxdemand`,min(`v2`.`location`) AS `loc` from `dr_pwrdmd_30min_view1` `v2` where (`v2`.`TARIFF` = 1) group by `v2`.`location`,cast(`v2`.`start_interval` as date));

DROP VIEW IF EXISTS `dr_pwrdmd_yearmax_view`;
CREATE VIEW  `dr_pwrdmd_yearmax_view` AS select max(year(`v1`.`start_interval`)) AS `year`,max(`v1`.`location`) AS `location`,max(`v1`.`demand`) AS `ON_max_demand`,min(date_format(`v1`.`start_interval`,'%Y/%m/%d %H:%i:%s')) AS `on_max_demand_time`,0 AS `off_max_demand`,'1900' AS `off_max_demand_time`,1 AS `tariff` from (`dr_pwrdmd_30min_view1` `v1` join `dr_pwrdmd_yearmax_tiff1_view` `ds` on(((`v1`.`start_interval` >= `ds`.`day`) and (`v1`.`start_interval` < (`ds`.`day` + interval 1 day)) and (`v1`.`demand` = `ds`.`maxdemand`) and (`v1`.`location` = `ds`.`loc`)))) where (`v1`.`TARIFF` = 1) group by `v1`.`location`,year(`v1`.`start_interval`) union select max(year(`v2`.`start_interval`)) AS `year`,max(`v2`.`location`) AS `location`,0 AS `on_max_demand`,'1900' AS `on_max_demand_time`,max(`v2`.`demand`) AS `OFF_max_demand`,min(date_format(`v2`.`start_interval`,'%Y/%m/%d %H:%i:%s')) AS `off_max_demand_time`,0 AS `tariff` from (`dr_pwrdmd_30min_view1` `v2` join `dr_pwrdmd_yearmax_tiff0_view` `ds2` on(((`v2`.`start_interval` >= `ds2`.`day`) and (`v2`.`start_interval` < (`ds2`.`day` + interval 1 day)) and (`v2`.`demand` = `ds2`.`maxdemand`) and (`v2`.`location` = `ds2`.`loc`)))) where (`v2`.`TARIFF` = 0) group by `v2`.`location`,year(`v2`.`start_interval`);


DROP VIEW IF EXISTS `node_summary`;
CREATE VIEW  `node_summary` AS select distinct `node_tree`.`p_key` AS `NODE_ID`,`node_tree`.`parent_node` AS `PARENT`,`node_tree`.`name` AS `NAME`,`node_type`.`type_value` AS `NODE_T`,`approval_state`.`state_value` AS `APPROVAL_S`,`func_has_children`(`node_tree`.`p_key`) AS `HAS_CHILDREN`,`func_desc_have_app_state`(`node_tree`.`p_key`,'Approved') AS `HAS_APPROVED_DESCENDANT`,`func_desc_have_app_state`(`node_tree`.`p_key`,'Unapproved') AS `HAS_UNAPPROVED_DESCENDANT` from ((`node_tree` join `node_type`) join `approval_state`) where ((`node_tree`.`fk_node_type` = `node_type`.`p_key`) and (`node_tree`.`fk_approval_state` = `approval_state`.`p_key`)) order by `node_tree`.`name`;

DROP VIEW IF EXISTS `operator_v`;
CREATE VIEW  `operator_v` AS select `operator`.`pkey` AS `PKEY`,`operator`.`name` AS `NAME`,`operator`.`passwd` AS `PASSWD`,`operator`.`accesslevel` AS `ACCESSLEVEL`,`operator`.`description` AS `DESCRIPTION`,`operator`.`is_system` AS `IS_SYSTEM`,`operator`.`created_by` AS `CREATED_BY`,`operator`.`date_created` AS `DATE_CREATED`,`operator`.`modified_by` AS `MODIFIED_BY`,`operator`.`date_modified` AS `DATE_MODIFIED` from `operator` where (`operator`.`deleted` = 0);

DROP VIEW IF EXISTS `parameter_names`;
CREATE VIEW  `parameter_names` AS select `step_type`.`type_value` AS `STEP_TYPE`,`parameter_type`.`type_name` AS `NAME` from ((`parameter_type` join `step_type`) join `step_type_parameter_types`) where ((`parameter_type`.`p_key` = `step_type_parameter_types`.`fk_parameter_type`) and (`parameter_type`.`p_key` <> 0) and (`step_type`.`p_key` = `step_type_parameter_types`.`fk_step_type`)) order by `step_type_parameter_types`.`position`;

DROP VIEW IF EXISTS `plan_details`;
CREATE VIEW  `plan_details` AS select `ntr`.`parent_node` AS `PARENT`,`ntr`.`p_key` AS `NODE_ID`,`ntr`.`name` AS `NAME`,`ntr`.`description` AS `DESCRIPTION`,`ntr`.`node_modified_by` AS `MODIFIED_BY`,`ntr`.`date_modified` AS `MODIFIED_TIME`,`ntr`.`approval_modified_by` AS `APPROVAL_CHANGED_BY`,`ntr`.`approval_date_modified` AS `APPROVAL_CHANGED_TIME`,`apps`.`state_value` AS `APPROVAL_STATE` from ((`node_tree` `ntr` join `approval_state` `apps`) join `node_type` `nty`) where ((`ntr`.`fk_approval_state` = `apps`.`p_key`) and (`ntr`.`fk_node_type` = `nty`.`p_key`) and (`nty`.`type_name` = 'Plan'));

DROP VIEW IF EXISTS `se_loc_reg_v`;
CREATE VIEW  `se_loc_reg_v` AS select distinct `entity`.`locationkey` AS `LOCATIONKEY`,`entity`.`seregi_id` AS `SEREGI_ID` from `entity`;

DROP VIEW IF EXISTS `se_profile_v`;
CREATE VIEW  `se_profile_v` AS select `se_profile`.`seprof_id` AS `SEPROF_ID`,`se_profile`.`name` AS `NAME`,`se_profile`.`septyp_id` AS `SEPTYP_ID`,`se_profile`.`consolemode` AS `CONSOLEMODE`,`se_profile`.`sepgro_id` AS `SEPGRO_ID`,if(`ra_itsi_group`.`name` is null or `ra_itsi_group`.`name` = '','',`ra_itsi_group`.`name`) AS `RAIGRO_NAME`,`se_profile`.`is_system` AS `IS_SYSTEM`,`se_profile`.`created_by` AS `CREATED_BY`,`se_profile`.`date_created` AS `DATE_CREATED`,`se_profile`.`modified_by` AS `MODIFIED_BY`,`se_profile`.`date_modified` AS `DATE_MODIFIED` from (`se_profile` left join `ra_itsi_group` on((`se_profile`.`raigro_id` = `ra_itsi_group`.`raigro_id`))) where (`se_profile`.`deleted` = 0);

DROP VIEW IF EXISTS `se_reg_sub_v`;
CREATE VIEW  `se_reg_sub_v` AS select distinct `entity`.`seregi_id` AS `SEREGI_ID`,`entity`.`physical_subsystem_key` AS `PHYSICAL_SUBSYSTEM_KEY` from `entity` where (`entity`.`physical_subsystem_key` <> '');

DROP VIEW IF EXISTS `se_resource_v`;
CREATE VIEW  `se_resource_v` AS select `entity`.`pkey` AS `PKEY`,`entity`.`name` AS `NAME`,if(`entity`.`physical_subsystem_key` is null or `entity`.`physical_subsystem_key` = '',`entity`.`subsystemkey`,`entity`.`physical_subsystem_key`) AS `SUBSYSTEMKEY` from `entity`;

-- DTL-ECS-ATS-R1
DROP VIEW IF EXISTS `at_fixed_block_map_v`;
CREATE VIEW  `at_fixed_block_map_v` AS select `m`.`atfblo_id` AS `ATFBLO_ID`,`m`.`branch_id` AS `BRANCH_ID`,(select `abt`.`track` from `at_branch_track` `abt` where (`abt`.`atbtra_id` = `m`.`branch_id`)) AS `TRACK`,`m`.`min_abscissa` AS `MIN_ABSCISSA`,`m`.`max_abscissa` AS `MAX_ABSCISSA`,`m`.`generic_id` AS `GENERIC_ID`,`m`.`zone_type` AS `ZONE_TYPE`,(select `zonetype`.`name` from `zonetype` where (`zonetype`.`pkey` = `m`.`zone_type`)) AS `ZONE_TYPE_NAME`,`m`.`ARM_ID` AS `ARM_ID`,`m`.`created_by` AS `CREATED_BY`,`m`.`date_created` AS `DATE_CREATED`,`m`.`modified_by` AS `MODIFIED_BY`,`m`.`date_modified` AS `DATE_MODIFIED` from `at_fixed_block_map` `m` order by `m`.`zone_type`,`m`.`branch_id`,`m`.`min_abscissa`;
